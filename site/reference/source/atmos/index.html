<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Reference for prepost/source/atmos.py - Pre-post classes for wind farm noise project</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Pre-post classes for wind farm noise project</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Overview</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../../source/" class="nav-link">Source</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../../WAPE.m" class="nav-link">WAPE</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#reference-for-prepostsourceatmospy" class="nav-link">Reference for prepost/source/atmos.py</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#src.prepost.source.atmos.Atmosphere" class="nav-link">Atmosphere</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="reference-for-prepostsourceatmospy">Reference for <code>prepost/source/atmos.py</code></h1>
<p><br></p>


<div class="doc doc-object doc-class">



<a id="src.prepost.source.atmos.Atmosphere"></a>
    <div class="doc doc-contents first">


        <p>Class to read and used ABL data from LES. 
The class provides methods to read velocity and temperature profile from LES. to define generic velocity profile. 
The class also providess function to compute the turbulence dissipation rate $\epsilon$ from the LES data</p>






              <details class="quote">
                <summary>Source code in <code>src/prepost/source/atmos.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Atmosphere</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to read and used ABL data from LES. </span>
<span class="sd">        The class provides methods to read velocity and temperature profile from LES. to define generic velocity profile. </span>
<span class="sd">        The class also providess function to compute the turbulence dissipation rate $\epsilon$ from the LES data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U_inf</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">epsilon_Kol</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">z_coord</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">H_mos</span> <span class="p">:</span> <span class="nb">float</span>                                                                                                 <span class="c1">#Sensible heat flux</span>
    <span class="n">L_star_mos</span> <span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_profile_from_les</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">fname</span><span class="p">,</span><span class="n">ratio</span><span class="p">,</span><span class="n">xpos</span><span class="p">,</span><span class="n">ypos</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;reading velocity profile from : &#39;</span> <span class="o">+</span> <span class="n">path</span><span class="o">+</span><span class="n">fname</span> <span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">ratio</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1">#Calculate the size of the grid</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:])</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">nz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">nz_tot</span> <span class="o">=</span> <span class="n">nz</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">z_i</span> <span class="o">=</span> <span class="mi">625</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span>
        <span class="c1">#Domain length</span>
        <span class="n">L_x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">z_i</span>
        <span class="n">L_y</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">z_i</span>
        <span class="n">L_z</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">z_i</span>

        <span class="c1">#Roughness height at the ground</span>
        <span class="n">z0lo</span> <span class="o">=</span> <span class="mf">1.67e-4</span><span class="o">*</span><span class="n">z_i</span>
        <span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.4</span>
        <span class="n">u_star</span> <span class="o">=</span> <span class="mf">0.6</span>

        <span class="c1">#Define the grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.000</span><span class="p">,</span><span class="n">L_x</span><span class="p">,</span><span class="n">nx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.000</span><span class="p">,</span><span class="n">L_y</span><span class="p">,</span><span class="n">ny</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.00</span><span class="p">,</span><span class="n">L_z</span><span class="p">,</span><span class="n">nz</span><span class="p">)</span>
        <span class="n">dz</span> <span class="o">=</span> <span class="n">z_i</span><span class="o">/</span><span class="p">(</span><span class="n">nz_tot</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">z_w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">z_i</span><span class="p">,</span><span class="n">nz_tot</span><span class="p">)</span> <span class="c1">#Location of w</span>
        <span class="n">z_w2</span> <span class="o">=</span> <span class="n">z_w2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nz</span><span class="p">]</span>
        <span class="n">z_uv2</span> <span class="o">=</span> <span class="n">z_w2</span><span class="o">+</span><span class="n">z_w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="c1">## Location of u,v</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">U_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">u</span><span class="p">[:,:,</span><span class="n">xpos</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">ny</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_coord</span> <span class="o">=</span> <span class="n">z_uv2</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">constant_epsilon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">epsilon</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_Kol</span> <span class="o">=</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z_coord</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><p><br><br></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
